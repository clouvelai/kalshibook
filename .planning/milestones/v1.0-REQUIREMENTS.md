# Requirements Archive: v1.0 MVP

**Archived:** 2026-02-17
**Status:** SHIPPED

For current requirements, see `.planning/REQUIREMENTS.md`.

---

# Requirements: KalshiBook

**Defined:** 2026-02-13
**Core Value:** Reliable, complete orderbook history for every Kalshi market â€” reconstructable to any point in time

## v1 Requirements

Requirements for initial release. Each maps to roadmap phases.

### Data Collection

- [x] **DCOL-01**: System connects to Kalshi websocket and maintains persistent connection with automatic reconnection
- [x] **DCOL-02**: System subscribes to orderbook channel for active/liquid Kalshi markets
- [x] **DCOL-03**: System receives and stores initial orderbook snapshot per market with timestamp
- [x] **DCOL-04**: System receives and stores all subsequent orderbook deltas with timestamps
- [x] **DCOL-05**: System validates sequence numbers on every delta and detects gaps
- [x] **DCOL-06**: System triggers re-snapshot when sequence gap detected (recovery)
- [x] **DCOL-07**: System auto-discovers new markets via market lifecycle websocket channel
- [x] **DCOL-08**: System auto-subscribes to newly discovered active markets

### Data Serving

- [x] **DSRV-01**: User can query reconstructed orderbook state at any historical timestamp for a given market
- [x] **DSRV-02**: User can query raw orderbook deltas by market and time range (paginated)
- [x] **DSRV-03**: User can list available markets with data coverage dates
- [x] **DSRV-04**: User can query market metadata (event info, contract specs)
- [x] **DSRV-05**: All API responses use consistent JSON format with structured error envelope

### Authentication & Access Control

- [x] **AUTH-01**: User can create account (email/password via Supabase Auth)
- [x] **AUTH-02**: User can generate API keys from dashboard
- [x] **AUTH-03**: API validates `X-API-Key` header on every request
- [x] **AUTH-04**: Per-key rate limiting enforced with standard response headers

### Billing & Monetization

- [x] **BILL-01**: Credit-based pricing: each API operation costs defined credits
- [x] **BILL-02**: Free tier: 1,000 credits/month (no credit card required)
- [x] **BILL-03**: Pay-as-you-go tier via Stripe
- [x] **BILL-04**: Project tier with monthly credit allocation via Stripe
- [x] **BILL-05**: Usage metering tracks credits consumed per API key
- [x] **BILL-06**: Access blocked when credits exhausted (with clear error message)

### Developer Experience

- [x] **DEVX-01**: OpenAPI 3.1 spec auto-generated and served at `/openapi.json`
- [x] **DEVX-02**: API documentation page hosted (Swagger/Redoc)
- [x] **DEVX-03**: `/llms.txt` and `/llms-full.txt` discovery files for AI agents
- [x] **DEVX-04**: Agent-friendly response design (flat JSON, natural language field names, contextual metadata)
- [x] **DEVX-05**: Interactive API playground in dashboard for testing endpoints

### Backtesting

- [x] **BKTS-01**: Collector captures public trade executions and trade history is queryable via API
- [x] **BKTS-02**: Settlement/resolution data normalized and queryable
- [x] **BKTS-03**: Candlestick data available at 1m, 1h, 1d intervals
- [x] **BKTS-04**: Event/market hierarchy exposed via API

### Dashboard

- [x] **DASH-01**: User can view and manage API keys (create, revoke)
- [x] **DASH-02**: User can view current usage and remaining credits
- [x] **DASH-03**: User can manage billing (link to Stripe customer portal)

## v2 Requirements

Deferred to future release. Tracked but not in current roadmap.

### SDKs

- **SDK-01**: Python SDK auto-generated from OpenAPI spec
- **SDK-02**: TypeScript SDK auto-generated from OpenAPI spec
- **SDK-03**: JavaScript SDK auto-generated from OpenAPI spec

### Real-time Streaming

- **STRM-01**: User can subscribe to real-time orderbook updates via websocket
- **STRM-02**: Streaming requires valid API key authentication on connect

### Advanced Features

- **ADV-01**: MCP server exposing KalshiBook endpoints as AI agent tools
- **ADV-02**: Downloadable flat files (CSV/Parquet) for bulk backtesting
- **ADV-03**: Enterprise tier with custom rate limits and SLAs
- **ADV-04**: Public trades capture via websocket

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| Trade execution / order placement | Read-only data product, not a brokerage |
| Multi-exchange aggregation (Polymarket, Manifold) | Deep on Kalshi first |
| OHLCV candle aggregation | Prediction markets don't fit candle model; Kalshi REST already has this |
| GraphQL API | REST-only, better for agents, simpler to rate-limit |
| Mobile app | Web dashboard + API only |
| Connection pooling / multi-WS redundancy | Future milestone after validating PMF |
| Derived metrics (spread, mid-price, order imbalance) | Users compute from raw data |

## Traceability

Which phases cover which requirements. Updated during roadmap creation.

| Requirement | Phase | Status |
|-------------|-------|--------|
| DCOL-01 | Phase 1 | Complete |
| DCOL-02 | Phase 1 | Complete |
| DCOL-03 | Phase 1 | Complete |
| DCOL-04 | Phase 1 | Complete |
| DCOL-05 | Phase 1 | Complete |
| DCOL-06 | Phase 1 | Complete |
| DCOL-07 | Phase 1 | Complete |
| DCOL-08 | Phase 1 | Complete |
| DSRV-01 | Phase 2 | Complete |
| DSRV-02 | Phase 2 | Complete |
| DSRV-03 | Phase 2 | Complete |
| DSRV-04 | Phase 2 | Complete |
| DSRV-05 | Phase 2 | Complete |
| AUTH-01 | Phase 2 | Complete |
| AUTH-02 | Phase 2 | Complete |
| AUTH-03 | Phase 2 | Complete |
| AUTH-04 | Phase 2 | Complete |
| DEVX-01 | Phase 2 | Complete |
| DEVX-02 | Phase 2 | Complete |
| DEVX-03 | Phase 2 | Complete |
| DEVX-04 | Phase 2 | Complete |
| BILL-01 | Phase 3 | Complete |
| BILL-02 | Phase 3 | Complete |
| BILL-03 | Phase 3 | Complete |
| BILL-04 | Phase 3 | Complete |
| BILL-05 | Phase 3 | Complete |
| BILL-06 | Phase 3 | Complete |
| BKTS-01 | Phase 4 | Complete |
| BKTS-02 | Phase 4 | Complete |
| BKTS-03 | Phase 4 | Complete |
| BKTS-04 | Phase 4 | Complete |
| DEVX-05 | Phase 6 | Complete |
| DASH-01 | Phase 5 | Complete |
| DASH-02 | Phase 5 | Complete |
| DASH-03 | Phase 5 | Complete |

**Coverage:**
- v1 requirements: 35 total (30 original + 4 BKTS + 1 DEVX-05)
- Mapped to phases: 35
- Unmapped: 0

---
*Requirements defined: 2026-02-13*
*Last updated: 2026-02-16 after v1 cleanup phase*
