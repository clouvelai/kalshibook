---
phase: 08-sdk-scaffolding
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - pyproject.toml
  - sdk/pyproject.toml
  - sdk/README.md
  - sdk/LICENSE
  - sdk/src/kalshibook/__init__.py
  - sdk/src/kalshibook/py.typed
  - sdk/src/kalshibook/client.py
  - sdk/src/kalshibook/models.py
  - sdk/src/kalshibook/exceptions.py
  - sdk/src/kalshibook/_http.py
  - sdk/src/kalshibook/_pagination.py
  - sdk/tests/__init__.py
  - sdk/tests/test_import.py
autonomous: true

must_haves:
  truths:
    - "pip install -e ./sdk installs kalshibook package with no errors"
    - "from kalshibook import KalshiBook succeeds in a Python 3.10+ interpreter"
    - "uv sync at workspace root resolves SDK alongside existing API code"
    - "Installed package includes only SDK code (no server code in distribution)"
    - "py.typed marker is present so mypy recognizes the package as typed"
  artifacts:
    - path: "pyproject.toml"
      provides: "Root project renamed to kalshibook-server with workspace config"
      contains: "kalshibook-server"
    - path: "sdk/pyproject.toml"
      provides: "SDK package metadata, build system, dependencies"
      contains: "uv_build"
    - path: "sdk/src/kalshibook/__init__.py"
      provides: "Package entry point with version and KalshiBook export"
      exports: ["KalshiBook", "__version__"]
    - path: "sdk/src/kalshibook/client.py"
      provides: "Empty KalshiBook class stub"
      contains: "class KalshiBook"
    - path: "sdk/src/kalshibook/py.typed"
      provides: "PEP 561 typed package marker"
    - path: "sdk/tests/test_import.py"
      provides: "Smoke test for package importability"
      contains: "from kalshibook import KalshiBook"
  key_links:
    - from: "sdk/src/kalshibook/__init__.py"
      to: "sdk/src/kalshibook/client.py"
      via: "from kalshibook.client import KalshiBook"
      pattern: "from kalshibook\\.client import KalshiBook"
    - from: "pyproject.toml"
      to: "sdk/pyproject.toml"
      via: "uv workspace members list"
      pattern: 'members = \["sdk"\]'
    - from: "sdk/pyproject.toml"
      to: "sdk/src/kalshibook/__init__.py"
      via: "uv_build src layout auto-discovery"
---

<objective>
Create the kalshibook Python SDK as a uv workspace member in the monorepo with package infrastructure, empty module stubs, and workspace integration.

Purpose: Establish the SDK package skeleton so that all subsequent phases (9-12) can add client logic, models, transport, and documentation into a working, installable package.
Output: Installable `kalshibook` package at `sdk/` with empty module stubs, verified by `uv sync` and import test.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-sdk-scaffolding/08-RESEARCH.md
@pyproject.toml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SDK package structure and integrate with uv workspace</name>
  <files>
    pyproject.toml
    sdk/pyproject.toml
    sdk/README.md
    sdk/LICENSE
    sdk/src/kalshibook/__init__.py
    sdk/src/kalshibook/py.typed
    sdk/src/kalshibook/client.py
    sdk/src/kalshibook/models.py
    sdk/src/kalshibook/exceptions.py
    sdk/src/kalshibook/_http.py
    sdk/src/kalshibook/_pagination.py
    sdk/tests/__init__.py
    sdk/tests/test_import.py
  </files>
  <action>
    **Step 1: Rename root project and add workspace config.**

    Edit root `pyproject.toml`:
    - Change `[project] name` from `"kalshibook"` to `"kalshibook-server"`. This avoids a uv workspace name collision with the SDK. Safe because the root has no `[build-system]`, is never published, and server code imports via `from src.api...` not `from kalshibook...`.
    - Add a new section at the end:
      ```toml
      [tool.uv.workspace]
      members = ["sdk"]
      ```

    **Step 2: Create SDK directory tree.**

    Create directories: `sdk/src/kalshibook/` and `sdk/tests/`.

    **Step 3: Create `sdk/pyproject.toml`.**

    Use the exact configuration from the research document (Pattern 3). Key details:
    - `name = "kalshibook"`, `version = "0.1.0"`
    - `requires-python = ">=3.10"`
    - `license = "MIT"`
    - `dependencies = ["httpx>=0.27"]`
    - `[project.optional-dependencies] pandas = ["pandas>=2.0"]`
    - `[build-system] requires = ["uv_build>=0.10.3,<0.11.0"]`, `build-backend = "uv_build"`
    - `[dependency-groups] dev` with pytest, pytest-asyncio, pytest-httpx, mypy, ruff
    - `[tool.ruff]` targeting py310, line-length 100
    - `[tool.pytest.ini_options]` with asyncio_mode auto, testpaths = ["tests"]
    - `[tool.mypy]` with python_version = "3.10", strict = true
    - Include classifiers: Alpha, Developers, Financial and Insurance Industry, MIT, Python 3.10-3.13, Typed

    **Step 4: Create `sdk/src/kalshibook/__init__.py`.**

    ```python
    """KalshiBook Python SDK -- L2 orderbook data for Kalshi prediction markets."""

    from __future__ import annotations

    __version__ = "0.1.0"

    from kalshibook.client import KalshiBook

    __all__ = ["KalshiBook", "__version__"]
    ```

    **Step 5: Create `sdk/src/kalshibook/client.py`.**

    Empty stub with the KalshiBook class (docstring only, body is `pass`). Include the class docstring from research Pattern 5 describing api_key and sync parameters. Use `from __future__ import annotations` at the top.

    **Step 6: Create empty module stubs.**

    Each of these files gets a module docstring and `from __future__ import annotations`:
    - `sdk/src/kalshibook/models.py` -- docstring: "Response models for KalshiBook API data."
    - `sdk/src/kalshibook/exceptions.py` -- docstring: "Exception hierarchy for KalshiBook SDK errors."
    - `sdk/src/kalshibook/_http.py` -- docstring: "HTTP transport layer (httpx-based, sync and async)."
    - `sdk/src/kalshibook/_pagination.py` -- docstring: "Cursor-based pagination helpers."

    **Step 7: Create `sdk/src/kalshibook/py.typed`.**

    Empty file (PEP 561 marker).

    **Step 8: Create `sdk/README.md`.**

    Minimal content: package name, one-line description ("Python SDK for the KalshiBook L2 orderbook data API"), install command (`pip install kalshibook`), basic usage example showing `from kalshibook import KalshiBook`, and a "Documentation coming soon" note. Keep it under 20 lines.

    **Step 9: Create `sdk/LICENSE`.**

    Standard MIT license text with "KalshiBook" as copyright holder and current year (2026).

    **Step 10: Create `sdk/tests/__init__.py`.**

    Empty file.

    **Step 11: Create `sdk/tests/test_import.py`.**

    Smoke test that verifies:
    - `from kalshibook import KalshiBook` succeeds
    - `from kalshibook import __version__` succeeds and equals "0.1.0"
    - `KalshiBook` is a class (using `inspect.isclass`)
    - The `kalshibook` package has a `py.typed` marker file (using `importlib.resources`)
  </action>
  <verify>
    Run `uv sync` at the workspace root -- must complete without errors.
    Run `python -c "from kalshibook import KalshiBook; print('OK')"` -- must print OK.
    Run `cd sdk && uv run pytest tests/test_import.py -v` -- all tests must pass.
  </verify>
  <done>
    Root pyproject.toml renamed to kalshibook-server with [tool.uv.workspace] members = ["sdk"]. SDK package at sdk/ has pyproject.toml with uv_build backend, flat module structure under sdk/src/kalshibook/ with __init__.py exporting KalshiBook and __version__, empty stubs for client/models/exceptions/_http/_pagination, py.typed marker, LICENSE, README.md, and passing smoke tests. uv sync resolves the workspace. from kalshibook import KalshiBook succeeds.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify distribution cleanliness and py.typed inclusion</name>
  <files></files>
  <action>
    **Step 1: Build the SDK distribution.**

    Run `cd sdk && uv build` to produce a wheel in `sdk/dist/`.

    **Step 2: Verify no server code leaked into the wheel.**

    Run `unzip -l sdk/dist/*.whl` and verify:
    - All `.py` files are under `kalshibook/` (the SDK package)
    - No files from `src/api/`, `src/collector/`, `src/shared/` appear
    - No server dependencies (asyncpg, fastapi, uvicorn, etc.) appear in metadata

    **Step 3: Verify py.typed is in the wheel.**

    Run `unzip -l sdk/dist/*.whl | grep py.typed` -- must show `kalshibook/py.typed`.

    **Step 4: Verify py.typed works at runtime.**

    Run:
    ```python
    python -c "
    import importlib.resources, kalshibook
    path = importlib.resources.files(kalshibook) / 'py.typed'
    assert path.is_file(), 'py.typed not found in installed package'
    print('py.typed: OK')
    "
    ```

    **Step 5: Clean up build artifacts.**

    Remove `sdk/dist/` and `sdk/*.egg-info` after verification.
  </action>
  <verify>
    The wheel contains only kalshibook/ package files and metadata -- no server code.
    py.typed is present in the wheel and detectable at runtime via importlib.resources.
  </verify>
  <done>
    Built SDK wheel contains only SDK module files (client.py, models.py, exceptions.py, _http.py, _pagination.py, __init__.py, py.typed) and package metadata. No server code leaks. py.typed marker is both in the wheel and detectable at runtime. Build artifacts cleaned up.
  </done>
</task>

</tasks>

<verification>
All five Phase 8 success criteria verified:
1. `pip install -e ./sdk` installs kalshibook package with no errors (via `uv sync` which does editable install)
2. `from kalshibook import KalshiBook` succeeds
3. `uv sync` at workspace root resolves SDK alongside existing API code
4. Built wheel includes only SDK code (verified by inspecting wheel contents)
5. `py.typed` marker present in package (verified by importlib.resources check)
</verification>

<success_criteria>
- `uv sync` completes without errors at workspace root
- `python -c "from kalshibook import KalshiBook"` exits 0
- `cd sdk && uv run pytest tests/test_import.py` passes all tests
- `uv build` in sdk/ produces a wheel containing only kalshibook/ files
- `py.typed` appears in wheel listing and is detectable via importlib.resources
</success_criteria>

<output>
After completion, create `.planning/phases/08-sdk-scaffolding/08-01-SUMMARY.md`
</output>
