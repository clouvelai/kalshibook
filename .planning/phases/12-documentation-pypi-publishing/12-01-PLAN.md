---
phase: 12-documentation-pypi-publishing
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - sdk/src/kalshibook/_version.py
  - sdk/src/kalshibook/__init__.py
  - sdk/src/kalshibook/_http.py
  - sdk/pyproject.toml
  - sdk/mkdocs.yml
  - sdk/scripts/gen_ref_pages.py
  - sdk/docs/index.md

must_haves:
  truths:
    - "mkdocs build succeeds in the sdk/ directory and renders the site"
    - "_version.py is the single source of truth for the version string"
    - "API reference pages are auto-generated from docstrings at build time"
    - "mkdocs-material theme renders with dark/light toggle, code copy, and search"
  artifacts:
    - path: "sdk/src/kalshibook/_version.py"
      provides: "Single version string"
      contains: "__version__"
    - path: "sdk/mkdocs.yml"
      provides: "mkdocs-material configuration with mkdocstrings"
      contains: "mkdocstrings"
    - path: "sdk/scripts/gen_ref_pages.py"
      provides: "Auto-generated API reference pages"
      contains: "mkdocs_gen_files"
    - path: "sdk/docs/index.md"
      provides: "Documentation home page"
  key_links:
    - from: "sdk/src/kalshibook/__init__.py"
      to: "sdk/src/kalshibook/_version.py"
      via: "import __version__"
      pattern: "from kalshibook._version import __version__"
    - from: "sdk/src/kalshibook/_http.py"
      to: "sdk/src/kalshibook/_version.py"
      via: "import __version__"
      pattern: "from kalshibook._version import __version__"
    - from: "sdk/mkdocs.yml"
      to: "sdk/scripts/gen_ref_pages.py"
      via: "gen-files plugin"
      pattern: "gen_ref_pages.py"

autonomous: true
---

<objective>
Set up mkdocs-material documentation infrastructure and fix version duplication.

Purpose: Creates the docs build pipeline so hand-written content (Plan 02) and CI workflows (Plan 03) have a working foundation. Also resolves the version duplication issue deferred from Phase 9.
Output: Working `mkdocs build` with auto-generated API reference, _version.py as single version source, updated pyproject.toml with docs deps and project URLs.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-documentation-pypi-publishing/12-RESEARCH.md
@sdk/pyproject.toml
@sdk/src/kalshibook/__init__.py
@sdk/src/kalshibook/_http.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix version duplication with _version.py and update pyproject.toml</name>
  <files>
    sdk/src/kalshibook/_version.py
    sdk/src/kalshibook/__init__.py
    sdk/src/kalshibook/_http.py
    sdk/pyproject.toml
  </files>
  <action>
    1. Create `sdk/src/kalshibook/_version.py` with a single line: `__version__ = "0.1.0"`.

    2. Update `sdk/src/kalshibook/__init__.py`:
       - Replace `__version__ = "0.1.0"` with `from kalshibook._version import __version__`
       - Keep everything else (imports, __all__) unchanged.

    3. Update `sdk/src/kalshibook/_http.py`:
       - Replace the `_VERSION = "0.1.0"` line and its comment with `from kalshibook._version import __version__`
       - Replace all usages of `_VERSION` with `__version__` in the file (User-Agent header string).

    4. Update `sdk/pyproject.toml`:
       - Add `[project.urls]` section after classifiers:
         ```
         Documentation = "https://kalshibook.github.io/kalshibook/"
         Repository = "https://github.com/kalshibook/kalshibook"
         Issues = "https://github.com/kalshibook/kalshibook/issues"
         Changelog = "https://github.com/kalshibook/kalshibook/releases"
         ```
       - Add a `docs` dependency group after the existing `dev` group:
         ```
         docs = [
             "mkdocs-material>=9.7",
             "mkdocstrings[python]>=1.0",
             "mkdocs-gen-files>=0.5",
             "mkdocs-literate-nav>=0.6",
             "mkdocs-section-index>=0.3",
         ]
         ```

    5. Run `cd sdk && python -c "from kalshibook._version import __version__; print(__version__)"` to verify no circular imports.
    6. Run `cd sdk && python -c "from kalshibook import KalshiBook, __version__; print(__version__)"` to verify the full import chain works.
    7. Run existing tests: `cd /Users/samuelclark/Desktop/kalshibook && uv run --package kalshibook pytest sdk/tests/ -x -q` to ensure nothing broke.
  </action>
  <verify>
    - `python -c "from kalshibook._version import __version__; print(__version__)"` prints `0.1.0`
    - `python -c "from kalshibook import __version__; print(__version__)"` prints `0.1.0`
    - No `_VERSION` references remain in `_http.py`
    - All existing tests pass
  </verify>
  <done>_version.py is the single source of truth for version. __init__.py and _http.py both import from it. pyproject.toml has project.urls and docs dependency group.</done>
</task>

<task type="auto">
  <name>Task 2: Create mkdocs.yml, gen_ref_pages.py, and docs index page</name>
  <files>
    sdk/mkdocs.yml
    sdk/scripts/gen_ref_pages.py
    sdk/docs/index.md
  </files>
  <action>
    1. Install docs dependencies: `uv sync --package kalshibook --group docs` (from workspace root).

    2. Create `sdk/mkdocs.yml` with the full configuration from the research (Pattern 1):
       - site_name: "KalshiBook Python SDK"
       - theme: material with indigo palette, dark/light toggle, code copy, navigation tabs, search
       - plugins: search, gen-files (pointing to scripts/gen_ref_pages.py), literate-nav, section-index, mkdocstrings with python handler (paths: [src], docstring_style: numpy, docstring_section_style: table, show_root_heading: true, show_source: false, separate_signature: true, show_signature_annotations: true, merge_init_into_class: true, members_order: source)
       - markdown_extensions: pymdownx.highlight (anchor_linenums, pygments_lang_class), pymdownx.superfences, pymdownx.tabbed (alternate_style), pymdownx.snippets, pymdownx.inlinehilite, admonition, pymdownx.details, attr_list, md_in_html, toc (permalink: true)
       - nav: Home (index.md), Getting Started (getting-started.md), Authentication (authentication.md), Examples (examples/ pages), API Reference (reference/)

    3. Create `sdk/scripts/gen_ref_pages.py` using the research Pattern 2:
       - Walk sdk/src/ for .py files
       - Skip private modules (starting with `_`) and __pycache__
       - Generate one ::: directive per public module
       - Build SUMMARY.md for literate-nav
       - PageIterator will appear via the __init__.py re-export page

    4. Create `sdk/docs/index.md` as a home page with:
       - Title: "KalshiBook Python SDK"
       - Brief description: L2 orderbook data for Kalshi prediction markets
       - Feature highlights: typed responses, sync/async, auto-pagination, DataFrame support
       - Quick install: `pip install kalshibook` / `pip install kalshibook[pandas]`
       - Link to Getting Started guide
       - Link to API Reference

    5. Run `cd sdk && uv run mkdocs build --strict` to verify the docs build succeeds. The nav will have broken links for getting-started.md, authentication.md, and examples/ since those are created in Plan 02 -- that is expected. Use `mkdocs build` (without --strict) if strict mode fails on missing nav targets. The key verification is that the API reference auto-generates correctly from docstrings.

    6. Verify the generated site has API reference pages: check that `sdk/site/reference/` contains generated HTML files with rendered docstring content.
  </action>
  <verify>
    - `cd sdk && uv run mkdocs build` completes without errors
    - `sdk/site/reference/` contains HTML files
    - `sdk/site/reference/index.html` contains KalshiBook class documentation
    - `sdk/site/index.html` exists with home page content
  </verify>
  <done>mkdocs-material builds successfully with auto-generated API reference from existing docstrings. All public methods and models are rendered in the reference section.</done>
</task>

</tasks>

<verification>
1. `cd sdk && python -c "from kalshibook import __version__; print(__version__)"` prints `0.1.0`
2. `cd sdk && uv run mkdocs build` succeeds
3. `ls sdk/site/reference/` shows auto-generated reference pages
4. `uv run --package kalshibook pytest sdk/tests/ -x -q` passes (no regressions)
5. `sdk/src/kalshibook/_version.py` exists and contains `__version__`
6. No `_VERSION` references in `_http.py`
</verification>

<success_criteria>
- mkdocs build produces a site with auto-generated API reference
- Version is sourced from a single _version.py file
- All existing SDK tests still pass
- pyproject.toml has project.urls and docs dependency group
</success_criteria>

<output>
After completion, create `.planning/phases/12-documentation-pypi-publishing/12-01-SUMMARY.md`
</output>
